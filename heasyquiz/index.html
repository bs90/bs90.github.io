<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>HeasyQuiz - Hello world!</title>
  <link href="https://fonts.googleapis.com/css?family=Spectral+SC" rel="stylesheet">
  <style>
    body {
      background-color: #34495e;
      text-align: center;
      font-family: 'Spectral SC', serif;
      color: #ecf0f1;
      font-size: 25px;
    }
    
    input {
      height:40px;
      font-size:25pt;
      text-align: center;
      font-family: 'Spectral SC', serif;
    }
    
    div {
      cursor: pointer;
    }
  </style>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script>
    $(function(){
      $("body").hide();
      var ip_info;
      $.getJSON('http://freegeoip.net/json/?callback=?', function(data) {
        ip_info = data;
        $("body").show();
      });
      $("div").click(function() {
        $("body").hide();
        var data = JSON.stringify({
          "key": "lock1",
          "value": $("input")[0].value,
          "ip_info": ip_info
        });
        
        var settings = {
          "async": true,
          "crossDomain": true,
          "url": "http://games.heasygame.com/passwords/check",
          "method": "POST",
          "headers": {
            "Content-Type": "application/json",
            "Cache-Control": "no-cache"
          },
          "processData": false,
          "data": data
        }

        $.ajax(settings).done(function (response) {
          var response = JSON.parse(response);
          if(response.status == "ok") {
            window.location.href = response["meta"]["url"] + ".html";
          } else {
            $("input")[0].value = "Sai rồi!";
            $("body").show();
          }
        });

        // var xhr = new XMLHttpRequest();
        // xhr.withCredentials = true;
        // xhr.addEventListener("readystatechange", function () {
        //   if (this.readyState === 4) {
        //     var response = JSON.parse(this.responseText);
        //     if(response.status == "ok") {
        //       window.location.href = response["meta"]["url"] + ".html";
        //     } else {
        //       $("input")[0].value = "Sai rồi!";
        //       $("body").show();
        //     }
        //   }
        // });
        // xhr.open("POST", "http://games.heasygame.com/passwords/check");
        // xhr.setRequestHeader("content-type", "application/json");
        // xhr.setRequestHeader("cache-control", "no-cache");
        // xhr.send(data);
      });
    });
  </script>
</head>
<body>
  <br/><br/><input placeholder="input anything" /><br/><br/>
  <div>SUBMIT</div>
</body>
</html>